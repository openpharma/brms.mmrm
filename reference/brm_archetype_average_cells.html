<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cell-means-like time-averaged archetype — brm_archetype_average_cells • brms.mmrm</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cell-means-like time-averaged archetype — brm_archetype_average_cells"><meta name="description" content="Create a cell-means-like informative prior archetype
with a special fixed effect to represent the average across time."><meta property="og:description" content="Create a cell-means-like informative prior archetype
with a special fixed effect to represent the average across time."><meta property="og:image" content="/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">brms.mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.9009</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Usage</h6></li>
    <li><a class="dropdown-item" href="../articles/usage.html">Usage</a></li>
    <li><a class="dropdown-item" href="../articles/subgroup.html">Subgroup analysis</a></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/archetypes.html">Informative prior archetypes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Validation</h6></li>
    <li><a class="dropdown-item" href="../articles/sbc.html">Simulation-based calibration checking</a></li>
    <li><a class="dropdown-item" href="../articles/fev1.html">FEV1 data comparison between Bayesian and frequentist MMRMs</a></li>
    <li><a class="dropdown-item" href="../articles/bcva.html">BCVA data comparison between Bayesian and frequentist MMRMs</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/brms.mmrm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Cell-means-like time-averaged archetype</h1>
      <small class="dont-index">Source: <a href="https://github.com/openpharma/brms.mmrm/blob/main/R/brm_archetype_average_cells.R" class="external-link"><code>R/brm_archetype_average_cells.R</code></a></small>
      <div class="d-none name"><code>brm_archetype_average_cells.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a cell-means-like informative prior archetype
with a special fixed effect to represent the average across time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">brm_archetype_average_cells</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  intercept <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  baseline <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"brm_baseline"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  baseline_subgroup <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"brm_baseline"</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>    <span class="st">"brm_subgroup"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  baseline_subgroup_time <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"brm_baseline"</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>    <span class="st">"brm_subgroup"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  baseline_time <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"brm_baseline"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  covariates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prefix_interest <span class="op">=</span> <span class="st">"x_"</span>,</span>
<span>  prefix_nuisance <span class="op">=</span> <span class="st">"nuisance_"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A classed data frame from <code><a href="brm_data.html">brm_data()</a></code>, or an informative
prior archetype from a function like <code><a href="brm_archetype_successive_cells.html">brm_archetype_successive_cells()</a></code>.</p></dd>


<dt id="arg-intercept">intercept<a class="anchor" aria-label="anchor" href="#arg-intercept"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> (default) to include an intercept, <code>FALSE</code> to omit.</p></dd>


<dt id="arg-baseline">baseline<a class="anchor" aria-label="anchor" href="#arg-baseline"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include an additive effect for baseline
response, <code>FALSE</code> to omit.
Default is <code>TRUE</code> if <code><a href="brm_data.html">brm_data()</a></code> previously declared a baseline
variable in the dataset.
Ignored for informative prior archetypes.
For informative prior archetypes, this option should be set in
functions like <code><a href="brm_archetype_successive_cells.html">brm_archetype_successive_cells()</a></code> rather than in
<code><a href="brm_formula.html">brm_formula()</a></code> in order to make sure columns are appropriately
centered and the underlying model matrix has full rank.</p></dd>


<dt id="arg-baseline-subgroup">baseline_subgroup<a class="anchor" aria-label="anchor" href="#arg-baseline-subgroup"></a></dt>
<dd><p>Logical of length 1.</p></dd>


<dt id="arg-baseline-subgroup-time">baseline_subgroup_time<a class="anchor" aria-label="anchor" href="#arg-baseline-subgroup-time"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include baseline-by-subgroup-by-time interaction,
<code>FALSE</code> to omit.
Default is <code>TRUE</code> if <code><a href="brm_data.html">brm_data()</a></code> previously declared baseline
and subgroup variables in the dataset.
Ignored for informative prior archetypes.
For informative prior archetypes, this option should be set in
functions like <code><a href="brm_archetype_successive_cells.html">brm_archetype_successive_cells()</a></code> rather than in
<code><a href="brm_formula.html">brm_formula()</a></code> in order to make sure columns are appropriately
centered and the underlying model matrix has full rank.</p></dd>


<dt id="arg-baseline-time">baseline_time<a class="anchor" aria-label="anchor" href="#arg-baseline-time"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include baseline-by-time interaction, <code>FALSE</code> to omit.
Default is <code>TRUE</code> if <code><a href="brm_data.html">brm_data()</a></code> previously declared a baseline
variable in the dataset.
Ignored for informative prior archetypes.
For informative prior archetypes, this option should be set in
functions like <code><a href="brm_archetype_successive_cells.html">brm_archetype_successive_cells()</a></code> rather than in
<code><a href="brm_formula.html">brm_formula()</a></code> in order to make sure columns are appropriately
centered and the underlying model matrix has full rank.</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> (default) to include any additive covariates declared with
the <code>covariates</code> argument of <code><a href="brm_data.html">brm_data()</a></code>,
<code>FALSE</code> to omit.
For informative prior archetypes, this option is set in
functions like <code><a href="brm_archetype_successive_cells.html">brm_archetype_successive_cells()</a></code> rather than in
<code><a href="brm_formula.html">brm_formula()</a></code> in order to make sure columns are appropriately
centered and the underlying model matrix has full rank.</p></dd>


<dt id="arg-prefix-interest">prefix_interest<a class="anchor" aria-label="anchor" href="#arg-prefix-interest"></a></dt>
<dd><p>Character string to prepend to the new columns
of generated fixed effects of interest (relating to group, subgroup,
and/or time).
In rare cases, you may need to set a non-default prefix to prevent
name conflicts with existing columns in the data, or rename
the columns in your data.
<code>prefix_interest</code> must not be the same value as <code>prefix_nuisance</code>.</p></dd>


<dt id="arg-prefix-nuisance">prefix_nuisance<a class="anchor" aria-label="anchor" href="#arg-prefix-nuisance"></a></dt>
<dd><p>Same as <code>prefix_interest</code>, but relating to
generated fixed effects NOT of interest (not relating to group,
subgroup, or time). Must not be the same value as <code>prefix_interest</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A special classed <code>tibble</code> with data tailored to
the cell-means-like time-averaged archetype. The dataset is augmented
with extra columns with the <code>"archetype_"</code> prefix, as well as special
attributes to tell downstream functions like <code><a href="brm_formula.html">brm_formula()</a></code> what to
do with the object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This archetype has a special fixed effect for each treatment group
to represent the mean response averaged across all the time points.</p>
<p>To illustrate, suppose the dataset has two treatment groups A and B,
time points 1, 2, and 3, and no other covariates.</p>
<p>Let <code>mu_gt</code> be the marginal mean of the response at group
<code>g</code> time <code>t</code> given data and hyperparameters.
The model has fixed effect parameters <code>beta_1</code>, <code>beta_2</code>, ..., <code>beta_6</code>
which express the marginal means <code>mu_gt</code> as follows:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>  <span class="st">`</span><span class="at">mu_A1 = 3 * beta_1 - beta_2 - beta_3</span><span class="st">`</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="st">`</span><span class="at">mu_A2 = beta_2</span><span class="st">`</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="st">`</span><span class="at">mu_A3 = beta_3</span><span class="st">`</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="st">`</span><span class="at">mu_B1 = 3 * beta_4 - beta_5 - beta_6</span><span class="st">`</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="st">`</span><span class="at">mu_B2 = beta_5</span><span class="st">`</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="st">`</span><span class="at">mu_B3 = beta_6</span><span class="st">`</span></span></code></pre><p></p></div>
<p>For group A, <code>beta_1</code> is the average response in group A
averaged across time points. You can confirm this yourself
by expressing the average across time
<code>(mu_A1 + mu_A2 + mu_A3) / 3</code> in terms of the <code>beta_*</code> parameters
and confirming that the expression simplifies down to just <code>beta_1</code>.
<code>beta_2</code> represents the mean response in group A at time 2, and
<code>beta_3</code> represents the mean response in group A at time 3.
<code>beta_4</code>, <code>beta_5</code>, and <code>beta_6</code> are analogous for group B.</p>
    </div>
    <div class="section level2">
    <h2 id="prior-labeling-for-brm-archetype-average-cells-">Prior labeling for <code>brm_archetype_average_cells()</code><a class="anchor" aria-label="anchor" href="#prior-labeling-for-brm-archetype-average-cells-"></a></h2>


<p>Within each treatment group, the initial time point represents
the average, and each successive time point represents the response
within that actual time.
To illustrate, consider the example in the Details section.
In the labeling scheme for <code>brm_archetype_average_cells()</code>,
you can label the prior on <code>beta_1</code> using
<code>brm_prior_label(code = "normal(1.2, 5)", group = "A", time = "1")</code>.
Similarly, you cal label the prior on <code>beta_5</code> with
<code>brm_prior_label(code = "normal(1.3, 7)", group = "B", time = "2")</code>.
To confirm that you set the prior correctly, compare the <code>brms</code> prior
with the output of <code>summary(your_archetype)</code>.
See the examples for details.</p>
    </div>
    <div class="section level2">
    <h2 id="nuisance-variables">Nuisance variables<a class="anchor" aria-label="anchor" href="#nuisance-variables"></a></h2>


<p>In the presence of covariate adjustment, functions like
<code><a href="brm_archetype_successive_cells.html">brm_archetype_successive_cells()</a></code> convert nuisance factors into binary
dummy variables, then center all those dummy variables and any
continuous nuisance variables at their means in the data.
This ensures that the main model coefficients
of interest are not implicitly conditional on a subset of the data.
In other words, preprocessing nuisance variables this way preserves
the interpretations of the fixed effects of interest, and it ensures
informative priors can be specified correctly.</p>
    </div>
    <div class="section level2">
    <h2 id="prior-labeling">Prior labeling<a class="anchor" aria-label="anchor" href="#prior-labeling"></a></h2>


<p>Informative prior archetypes use a labeling scheme to assign priors
to fixed effects. How it works:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fl">1.</span> First, assign the prior of each parameter a collection</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  of labels from the data. This can be done manually or with</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  successive calls to [<span class="fu">brm_prior_label</span>()].</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fl">2.</span> Supply the labeling scheme to [<span class="fu">brm_prior_archetype</span>()].</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  [<span class="fu">brm_prior_archetype</span>()] uses attributes of the archetype</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  to map labeled priors to their rightful parameters <span class="cf">in</span> the model.</span></code></pre><p></p></div>
<p>For informative prior archetypes, this process is much more convenient
and robust than manually calling <code><a href="https://paul-buerkner.github.io/brms/reference/set_prior.html" class="external-link">brms::set_prior()</a></code>.
However, it requires an understanding of how the labels of the priors
map to parameters in the model. This mapping varies from archetype
to archetype, and it is documented in the help pages of
archetype-specific functions such as <code><a href="brm_archetype_successive_cells.html">brm_archetype_successive_cells()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other informative prior archetypes:
<code><a href="brm_archetype_average_effects.html">brm_archetype_average_effects</a>()</code>,
<code><a href="brm_archetype_cells.html">brm_archetype_cells</a>()</code>,
<code><a href="brm_archetype_effects.html">brm_archetype_effects</a>()</code>,
<code><a href="brm_archetype_successive_cells.html">brm_archetype_successive_cells</a>()</code>,
<code><a href="brm_archetype_successive_effects.html">brm_archetype_successive_effects</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="brm_simulate_outline.html">brm_simulate_outline</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  n_group <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  n_patient <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  n_time <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  rate_dropout <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  rate_lapse <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="brm_data_change.html">brm_data_change</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="brm_simulate_continuous.html">brm_simulate_continuous</a></span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"biomarker1"</span>, <span class="st">"biomarker2"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="brm_simulate_categorical.html">brm_simulate_categorical</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"status1"</span>, <span class="st">"status2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"present"</span>, <span class="st">"absent"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">data</span>,</span></span>
<span class="r-in"><span>  <span class="va">group</span>,</span></span>
<span class="r-in"><span>  <span class="va">time</span>,</span></span>
<span class="r-in"><span>  <span class="va">patient</span>,</span></span>
<span class="r-in"><span>  <span class="fu">starts_with</span><span class="op">(</span><span class="st">"biomarker"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu">starts_with</span><span class="op">(</span><span class="st">"status"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 600 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    group   time   patient     biomarker1 biomarker2 status1 status2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> group_1 time_2 patient_001     -<span style="color: #BB0000;">1.42</span>      -<span style="color: #BB0000;">0.287</span> absent  present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> group_1 time_3 patient_001     -<span style="color: #BB0000;">1.42</span>      -<span style="color: #BB0000;">0.287</span> absent  present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> group_1 time_4 patient_001     -<span style="color: #BB0000;">1.42</span>      -<span style="color: #BB0000;">0.287</span> absent  present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> group_1 time_2 patient_002     -<span style="color: #BB0000;">1.67</span>       1.84  absent  present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> group_1 time_3 patient_002     -<span style="color: #BB0000;">1.67</span>       1.84  absent  present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> group_1 time_4 patient_002     -<span style="color: #BB0000;">1.67</span>       1.84  absent  present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> group_1 time_2 patient_003      1.38      -<span style="color: #BB0000;">0.157</span> absent  absent </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> group_1 time_3 patient_003      1.38      -<span style="color: #BB0000;">0.157</span> absent  absent </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> group_1 time_4 patient_003      1.38      -<span style="color: #BB0000;">0.157</span> absent  absent </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> group_1 time_2 patient_004     -<span style="color: #BB0000;">0.920</span>     -<span style="color: #BB0000;">1.39</span>  present present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 590 more rows</span></span>
<span class="r-in"><span><span class="va">archetype</span> <span class="op">&lt;-</span> <span class="fu">brm_archetype_average_cells</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">archetype</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 600 × 23</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    x_group_1_time_2 x_group_1_time_3 x_group_1_time_4 x_group_2_time_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>                3               -<span style="color: #BB0000;">1</span>               -<span style="color: #BB0000;">1</span>                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>                0                1                0                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>                0                0                1                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>                3               -<span style="color: #BB0000;">1</span>               -<span style="color: #BB0000;">1</span>                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>                0                1                0                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>                0                0                1                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>                3               -<span style="color: #BB0000;">1</span>               -<span style="color: #BB0000;">1</span>                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>                0                1                0                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>                0                0                1                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>                3               -<span style="color: #BB0000;">1</span>               -<span style="color: #BB0000;">1</span>                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 590 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 19 more variables: x_group_2_time_3 &lt;int&gt;, x_group_2_time_4 &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   nuisance_biomarker1 &lt;dbl&gt;, nuisance_biomarker2 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   nuisance_status1_absent &lt;dbl&gt;, nuisance_status2_present &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   nuisance_baseline &lt;dbl&gt;, nuisance_baseline.timetime_2 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   nuisance_baseline.timetime_3 &lt;dbl&gt;, patient &lt;chr&gt;, time &lt;chr&gt;, group &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   missing &lt;lgl&gt;, change &lt;dbl&gt;, baseline &lt;dbl&gt;, biomarker1 &lt;dbl&gt;, …</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">archetype</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> # This is the "average cells" informative prior archetype in brms.mmrm.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> # The following equations show the relationships between the</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> # marginal means (left-hand side) and fixed effect parameters</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> # (right-hand side).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> # </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> #   group_1:time_2 = 3*x_group_1_time_2 - x_group_1_time_3 - x_group_1_time_4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> #   group_1:time_3 = x_group_1_time_3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> #   group_1:time_4 = x_group_1_time_4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> #   group_2:time_2 = 3*x_group_2_time_2 - x_group_2_time_3 - x_group_2_time_4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> #   group_2:time_3 = x_group_2_time_3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> #   group_2:time_4 = x_group_2_time_4</span>
<span class="r-in"><span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="brm_formula.html">brm_formula</a></span><span class="op">(</span><span class="va">archetype</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">formula</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> change ~ 0 + x_group_1_time_2 + x_group_1_time_3 + x_group_1_time_4 + x_group_2_time_2 + x_group_2_time_3 + x_group_2_time_4 + nuisance_biomarker1 + nuisance_biomarker2 + nuisance_status1_absent + nuisance_status2_present + nuisance_baseline + nuisance_baseline.timetime_2 + nuisance_baseline.timetime_3 + unstr(time = time, gr = patient) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma ~ 0 + time</span>
<span class="r-in"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  code <span class="op">=</span> <span class="st">"normal(1, 2.2)"</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="st">"group_1"</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="st">"time_2"</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span><span class="st">"normal(1, 3.3)"</span>, group <span class="op">=</span> <span class="st">"group_1"</span>, time <span class="op">=</span> <span class="st">"time_3"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span><span class="st">"normal(1, 4.4)"</span>, group <span class="op">=</span> <span class="st">"group_1"</span>, time <span class="op">=</span> <span class="st">"time_4"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span><span class="st">"normal(2, 2.2)"</span>, group <span class="op">=</span> <span class="st">"group_2"</span>, time <span class="op">=</span> <span class="st">"time_2"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span><span class="st">"normal(2, 3.3)"</span>, group <span class="op">=</span> <span class="st">"group_2"</span>, time <span class="op">=</span> <span class="st">"time_3"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span><span class="st">"normal(2, 4.4)"</span>, group <span class="op">=</span> <span class="st">"group_2"</span>, time <span class="op">=</span> <span class="st">"time_4"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="brm_prior_archetype.html">brm_prior_archetype</a></span><span class="op">(</span><span class="va">archetype</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prior</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           prior class             coef group resp dpar nlpar   lb   ub source</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  normal(1, 2.2)     b x_group_1_time_2                       &lt;NA&gt; &lt;NA&gt;   user</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  normal(1, 3.3)     b x_group_1_time_3                       &lt;NA&gt; &lt;NA&gt;   user</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  normal(1, 4.4)     b x_group_1_time_4                       &lt;NA&gt; &lt;NA&gt;   user</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  normal(2, 2.2)     b x_group_2_time_2                       &lt;NA&gt; &lt;NA&gt;   user</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  normal(2, 3.3)     b x_group_2_time_3                       &lt;NA&gt; &lt;NA&gt;   user</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  normal(2, 4.4)     b x_group_2_time_4                       &lt;NA&gt; &lt;NA&gt;   user</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">prior</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "brmsprior"  "data.frame"</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"BRM_EXAMPLES"</span>, unset <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, <span class="st">"true"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="brm_model.html">brm_model</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        data <span class="op">=</span> <span class="va">archetype</span>,</span></span>
<span class="r-in"><span>        formula <span class="op">=</span> <span class="va">formula</span>,</span></span>
<span class="r-in"><span>        prior <span class="op">=</span> <span class="va">prior</span>,</span></span>
<span class="r-in"><span>        chains <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>        iter <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>        refresh <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstantools/reference/prior_summary.html" class="external-link">prior_summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu"><a href="brm_marginal_draws.html">brm_marginal_draws</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">archetype</span>,</span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">formula</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">model</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">summaries_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="brm_marginal_summaries.html">brm_marginal_summaries</a></span><span class="op">(</span><span class="va">draws</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">summaries_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="brm_marginal_data.html">brm_marginal_data</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="brm_plot_compare.html">brm_plot_compare</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">summaries_model</span>, data <span class="op">=</span> <span class="va">summaries_data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by William Michael Landau, Kevin Kunzmann, Yoni Sidi, Christian Stock, Eli Lilly and Company, Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

