<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Formula for standard deviation parameters — brm_formula_sigma • brms.mmrm</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Formula for standard deviation parameters — brm_formula_sigma"><meta name="description" content="Parameterize standard deviations using
a formula for the sigma argument of brm_formula()."><meta property="og:description" content="Parameterize standard deviations using
a formula for the sigma argument of brm_formula()."><meta property="og:image" content="/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">brms.mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Usage</h6></li>
    <li><a class="dropdown-item" href="../articles/usage.html">Usage</a></li>
    <li><a class="dropdown-item" href="../articles/subgroup.html">Subgroup analysis</a></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/archetypes.html">Informative prior archetypes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Validation</h6></li>
    <li><a class="dropdown-item" href="../articles/sbc.html">Simulation-based calibration checking</a></li>
    <li><a class="dropdown-item" href="../articles/fev1.html">FEV1 data comparison between Bayesian and frequentist MMRMs</a></li>
    <li><a class="dropdown-item" href="../articles/bcva.html">BCVA data comparison between Bayesian and frequentist MMRMs</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/brms.mmrm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Formula for standard deviation parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/openpharma/brms.mmrm/blob/main/R/brm_formula_sigma.R" class="external-link"><code>R/brm_formula_sigma.R</code></a></small>
      <div class="d-none name"><code>brm_formula_sigma.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Parameterize standard deviations using
a formula for the <code>sigma</code> argument of <code><a href="brm_formula.html">brm_formula()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">brm_formula_sigma</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  check_rank <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  intercept <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  baseline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  baseline_subgroup <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  baseline_subgroup_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  baseline_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  covariates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group_subgroup <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group_subgroup_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  subgroup <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  subgroup_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  time <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A classed data frame from <code><a href="brm_data.html">brm_data()</a></code>, or an informative
prior archetype from a function like <code><a href="brm_archetype_successive_cells.html">brm_archetype_successive_cells()</a></code>.</p></dd>


<dt id="arg-check-rank">check_rank<a class="anchor" aria-label="anchor" href="#arg-check-rank"></a></dt>
<dd><p><code>TRUE</code> to check the rank of the model matrix
for <code>sigma</code> and throw an error if rank deficiency is detected.
<code>FALSE</code> to skip this check.
Rank-deficiency may cause <code>sigma</code> to be non-identifiable,
may prevent the MCMC from converging.</p></dd>


<dt id="arg-intercept">intercept<a class="anchor" aria-label="anchor" href="#arg-intercept"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> (default) to include an intercept, <code>FALSE</code> to omit.</p></dd>


<dt id="arg-baseline">baseline<a class="anchor" aria-label="anchor" href="#arg-baseline"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include an additive effect for baseline
response, <code>FALSE</code> to omit.
If <code>TRUE</code>, then effect size will be omitted from the output of
<code><a href="brm_marginal_draws.html">brm_marginal_draws()</a></code>.</p></dd>


<dt id="arg-baseline-subgroup">baseline_subgroup<a class="anchor" aria-label="anchor" href="#arg-baseline-subgroup"></a></dt>
<dd><p>Logical of length 1.</p></dd>


<dt id="arg-baseline-subgroup-time">baseline_subgroup_time<a class="anchor" aria-label="anchor" href="#arg-baseline-subgroup-time"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include baseline-by-subgroup-by-time interaction,
<code>FALSE</code> to omit.
If <code>TRUE</code>, then effect size will be omitted from the output of
<code><a href="brm_marginal_draws.html">brm_marginal_draws()</a></code>.</p></dd>


<dt id="arg-baseline-time">baseline_time<a class="anchor" aria-label="anchor" href="#arg-baseline-time"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include baseline-by-time interaction, <code>FALSE</code> to omit.
If <code>TRUE</code>, then effect size will be omitted from the output of
<code><a href="brm_marginal_draws.html">brm_marginal_draws()</a></code>.</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> (default) to include any additive covariates declared with
the <code>covariates</code> argument of <code><a href="brm_data.html">brm_data()</a></code>,
<code>FALSE</code> to omit.
If <code>TRUE</code>, then effect size will be omitted from the output of
<code><a href="brm_marginal_draws.html">brm_marginal_draws()</a></code>.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> (default) to include additive effects for
treatment groups, <code>FALSE</code> to omit.</p></dd>


<dt id="arg-group-subgroup">group_subgroup<a class="anchor" aria-label="anchor" href="#arg-group-subgroup"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include group-by-subgroup interaction, <code>FALSE</code> to omit.</p></dd>


<dt id="arg-group-subgroup-time">group_subgroup_time<a class="anchor" aria-label="anchor" href="#arg-group-subgroup-time"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include group-by-subgroup-by-time interaction, <code>FALSE</code> to omit.</p></dd>


<dt id="arg-group-time">group_time<a class="anchor" aria-label="anchor" href="#arg-group-time"></a></dt>
<dd><p>Logical of length 1.</p></dd>


<dt id="arg-subgroup">subgroup<a class="anchor" aria-label="anchor" href="#arg-subgroup"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include additive fixed effects for subgroup levels,
<code>FALSE</code> to omit.</p></dd>


<dt id="arg-subgroup-time">subgroup_time<a class="anchor" aria-label="anchor" href="#arg-subgroup-time"></a></dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include subgroup-by-time interaction, <code>FALSE</code> to omit.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>Logical of length 1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A base R formula with S3 class <code>"brms_mmrm_formula_sigma"</code>.
This formula controls the parameterization of <code>sigma</code>, the linear-scale
<code>brms</code> distributional parameters which represent standard deviations.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In <code>brms</code>, the standard deviations of the residuals are
modeled through a parameter vector called <code>sigma</code>. <code>brms.mmrm</code>
always treats <code>sigma</code> as a distributional parameter
(<a href="https://paulbuerkner.com/brms/articles/brms_distreg.html" class="external-link">https://paulbuerkner.com/brms/articles/brms_distreg.html</a>).
<code>brm_formula_sigma()</code> lets you control the parameterization of <code>sigma</code>.
The output of <code>brm_formula_sigma()</code> serves as input to the <code>sigma</code>
argument of <code><a href="brm_formula.html">brm_formula()</a></code>.</p>
<p>The default <code>sigma</code> formula is <code>sigma ~ 0 + time</code>, where <code>time</code>
is the discrete time variable in the data. This is the usual
heterogeneous variance structure which declares
one standard deviation parameter for each time point in the data.
Alternatively, you could write
<code>brm_formula_sigma(data, intercept = TRUE, time = FALSE)</code>.
This will produce <code>sigma ~ 1</code>, which yields a single scalar variance
(a structure termed "homogeneous variance").</p>
<p>With arguments like <code>baseline</code> and <code>covariates</code>, you can
specify extremely complicated variance structures. However,
if baseline or covariates are used, then the output of
<code><a href="brm_marginal_draws.html">brm_marginal_draws()</a></code> omit effect size due to the statistical
challenges of calculating marginal means of draws of <code>sigma</code>
for this uncommon scenario.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other models:
<code><a href="brm_formula.html">brm_formula</a>()</code>,
<code><a href="brm_model.html">brm_model</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="brm_data.html">brm_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="brm_simulate_simple.html">brm_simulate_simple</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> <span class="st">"response"</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="st">"time"</span>,</span></span>
<span class="r-in"><span>  patient <span class="op">=</span> <span class="st">"patient"</span>,</span></span>
<span class="r-in"><span>  reference_group <span class="op">=</span> <span class="st">"group_1"</span>,</span></span>
<span class="r-in"><span>  reference_time <span class="op">=</span> <span class="st">"time_1"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">homogeneous</span> <span class="op">&lt;-</span> <span class="fu">brm_formula_sigma</span><span class="op">(</span><span class="va">data</span>, time <span class="op">=</span> <span class="cn">FALSE</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">by_group</span> <span class="op">&lt;-</span> <span class="fu">brm_formula_sigma</span><span class="op">(</span><span class="va">data</span>, group <span class="op">=</span> <span class="cn">TRUE</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">homogeneous</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma ~ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"brm_allow_effect_size")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55ecd29f33a0&gt;</span>
<span class="r-in"><span><span class="va">by_group</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma ~ group + time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"brm_allow_effect_size")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55ecd1d958d8&gt;</span>
<span class="r-in"><span><span class="fu"><a href="brm_formula.html">brm_formula</a></span><span class="op">(</span><span class="va">data</span>, sigma <span class="op">=</span> <span class="va">homogeneous</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> response ~ group + group:time + time + unstr(time = time, gr = patient) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma ~ 1</span>
<span class="r-in"><span><span class="fu"><a href="brm_formula.html">brm_formula</a></span><span class="op">(</span><span class="va">data</span>, sigma <span class="op">=</span> <span class="va">by_group</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> response ~ group + group:time + time + unstr(time = time, gr = patient) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma ~ group + time</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by William Michael Landau, Kevin Kunzmann, Yoni Sidi, Christian Stock, Eli Lilly and Company, Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

